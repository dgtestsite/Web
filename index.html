<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NHL Trade Simulator</title>
<style>
  body { font-family: Arial, sans-serif; }
  table { border-collapse: collapse; margin: 20px; width: 45%; float: left; }
  th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
  th { background: #eee; }
  .container { display: flex; justify-content: space-between; }
  button { margin: 10px 0; }
</style>
</head>
<body>

<h1>NHL Trade Simulator</h1>
<div>
  <label for="team1">Team 1:</label>
  <select id="team1"></select>
  <label for="team2">Team 2:</label>
  <select id="team2"></select>
</div>

<div class="container">
  <table id="roster1">
    <thead><tr><th>Name</th><th>Position</th><th>Salary</th></tr></thead>
    <tbody></tbody>
  </table>

  <table id="roster2">
    <thead><tr><th>Name</th><th>Position</th><th>Salary</th></tr></thead>
    <tbody></tbody>
  </table>
</div>

<button onclick="proposeTrade()">Propose Trade</button>
<p id="tradeMessage"></p>

<script>
// Sample NHL data (replace with full dataset)
const teams = {
  "Toronto Maple Leafs": [
    {name: "Auston Matthews", pos: "C", salary: 11800000},
    {name: "Mitch Marner", pos: "RW", salary: 10700000},
  ],
  "Montreal Canadiens": [
    {name: "Nick Suzuki", pos: "C", salary: 7750000},
    {name: "Cole Caufield", pos: "RW", salary: 5000000},
  ]
};

const salaryCap = 82500000;

function populateTeams() {
  const team1 = document.getElementById('team1');
  const team2 = document.getElementById('team2');
  Object.keys(teams).forEach(t => {
    team1.add(new Option(t, t));
    team2.add(new Option(t, t));
  });
  updateRosters();
}

function updateRosters() {
  const t1 = document.getElementById('team1').value;
  const t2 = document.getElementById('team2').value;

  function fillRoster(tableId, roster) {
    const tbody = document.getElementById(tableId).querySelector('tbody');
    tbody.innerHTML = '';
    roster.forEach(player => {
      const row = document.createElement('tr');
      row.innerHTML = `<td>${player.name}</td><td>${player.pos}</td><td>${player.salary.toLocaleString()}</td>`;
      row.onclick = () => row.classList.toggle('selected');
      tbody.appendChild(row);
    });
  }

  fillRoster('roster1', teams[t1]);
  fillRoster('roster2', teams[t2]);
}

function proposeTrade() {
  const t1 = document.getElementById('team1').value;
  const t2 = document.getElementById('team2').value;

  const selected1 = Array.from(document.getElementById('roster1').querySelectorAll('.selected'));
  const selected2 = Array.from(document.getElementById('roster2').querySelectorAll('.selected'));

  const tradeSalary1 = selected1.reduce((sum, row) => sum + parseInt(row.cells[2].innerText.replace(/,/g, '')), 0);
  const tradeSalary2 = selected2.reduce((sum, row) => sum + parseInt(row.cells[2].innerText.replace(/,/g, '')), 0);

  const team1Current = teams[t1].reduce((sum, p) => sum + p.salary, 0);
  const team2Current = teams[t2].reduce((sum, p) => sum + p.salary, 0);

  if(team1Current - tradeSalary1 + tradeSalary2 > salaryCap || team2Current - tradeSalary2 + tradeSalary1 > salaryCap) {
    document.getElementById('tradeMessage').innerText = "Trade violates salary cap!";
    return;
  }

  // Execute trade
  selected1.forEach(row => {
    const idx = teams[t1].findIndex(p => p.name === row.cells[0].innerText);
    teams[t2].push(teams[t1].splice(idx,1)[0]);
  });
  selected2.forEach(row => {
    const idx = teams[t2].findIndex(p => p.name === row.cells[0].innerText);
    teams[t1].push(teams[t2].splice(idx,1)[0]);
  });

  document.getElementById('tradeMessage').innerText = "Trade executed!";
  updateRosters();
}

document.getElementById('team1').addEventListener('change', updateRosters);
document.getElementById('team2').addEventListener('change', updateRosters);
populateTeams();
</script>

</body>
</html>
